<!-- backend production creation and production edition errors error messages -->
<div class="alert alert-danger alert-positioning" role="alert"
     [@showHideError]="unsuccessfulCreation || unsuccessfulEdit ? 'open' : 'closed'">
  {{ errorMessage }}
  <button type="button" class="close ml-3" (click)="hideMessageFunc()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<!-- successful creation message-->
<div class="alert alert-success alert-positioning" role="alert" [@showHideError]="successfulCreation ? 'open' : 'closed'">
  محصول مورد نظر با موفقیت ثبت شد
  <button type="button" class="close ml-3" (click)="hideMessageFunc()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<!-- successful edition message-->
<div class="alert alert-success alert-positioning" role="alert" [@showHideError]="successfulEdit ? 'open' : 'closed'">
  محصول مورد نظر با موفقیت ویرایش شد
  <button type="button" class="close ml-3" (click)="hideMessageFunc()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<!-- successful delete message-->
<div class="alert alert-success alert-positioning" role="alert" [@showHideError]="isDeleted ? 'open' : 'closed'">
  محصول مورد نظر با موفقیت حذف شد
  <button type="button" class="close ml-3" (click)="hideMessageFunc()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<div id="table-container" class="container d-flex flex-column align-items-center justify-content-center">
  <button mat-raised-button color="accent" class="align-self-start  mt-5" (click)="showCreateFormFunc()">محصول جدید +</button>

  <!-- production creation form -->
  <form [formGroup]="productionForm" class="mb-2" (ngSubmit)="createProduction()"
        [@openClose]="showCreateForm ? 'open' : 'closed'">
    <div class="form-group row">
      <label for="title" class="col-sm-3 col-form-label ">نام :</label>
      <div class="col-sm-9">
        <!-- setting input as relative for errors to show infront of them -->
        <input id="title" formControlName="title" type="text" class="form-control position-relative">
        <div *ngIf="formTitle.invalid && (formTitle.touched || formTitle.dirty)"
             class="alert alert-danger validation-error">
          <div *ngIf="formTitle.errors?.['required']" class="validation-error-text">
            فیلد نام اشتباه است
          </div>
        </div>
      </div>
    </div>

    <div class="form-group row">
      <label for="strategic-resource" class="col-form-label col-sm-4 ml-0 pl-0">منبع استراتجیک:</label>
      <div class="col-sm-8">
        <input id="strategic-resource" type="number" formControlName="strategicResource" class="form-control">
        <div *ngIf="formstrategicResource.invalid && (formstrategicResource.touched || formstrategicResource.dirty)"
        class="validation-error alert alert-danger strategic-error">
          <div *ngIf="formstrategicResource.errors?.['required']" class="validation-error-text">
            منبع استراتجیک اشتباه است
          </div>
        </div>
      </div>
    </div>

    <div class="form-group row">
        <label for="code" class="col-sm-3 col-form-label">کد :</label>
        <div class="col-sm-9">
          <input id="code" type="text" formControlName="code" class="form-control">
          <div *ngIf="formcode.invalid && (formcode.touched || formcode.dirty)"
               class="alert alert-danger validation-error">
            <div *ngIf="formcode.errors?.['required']" class="validation-error-text">
              فیلد کد اشتباه است
            </div>
          </div>
      </div>
    </div>

    <div class="form-group row">
        <label for="warehouse-id" class="col-sm-3 col-form-label">کد انبار :</label>
        <div class="col-sm-9">
          <input id="warehouse-id" type="number" formControlName="warehouseId" class="form-control">
          <div *ngIf="formWarehouseId.invalid && (formWarehouseId.touched || formWarehouseId.dirty)"
               class="alert alert-danger validation-error">
            <div *ngIf="formWarehouseId.errors?.['required']" class="validation-error-text">
              کد انبار اشتباه است
            </div>
          </div>
        </div>
    </div>

    <!-- to avoid overlapping creating and edit buttons -->
    <div *ngIf="showCreateForm">
      <button class="btn btn-primary pr-4 pl-4" type="submit">تایید</button>
    </div>

  </form>
  <!-- Production edit form -->
  <form [formGroup]="productionForm" class="mb-5" (ngSubmit)="updateProduction()"
        [@openClose]="showEditForm ? 'open' : 'closed'">
    <div class="form-group row">
      <label for="edit-title" class="col-sm-3 col-form-label ">نام :</label>
      <div class="col-sm-9">
        <!-- setting input as relative for errors to show infront of them -->
        <input id="edit-title" formControlName="title" type="text" class="form-control position-relative">
        <div *ngIf="formTitle.invalid && (formTitle.touched || formTitle.dirty)"
             class="alert alert-danger validation-error">
          <div *ngIf="formTitle.errors?.['required']" class="validation-error-text">
            فیلد نام اشتباه است
          </div>
        </div>
      </div>
    </div>

    <div class="form-group row">
      <label for="edit-strategic-resource" class="col-form-label col-sm-4 ml-0 pl-0">منبع استراتجیک:</label>
      <div class="col-sm-8">
        <input id="edit-strategic-resource" type="number" formControlName="strategicResource" class="form-control">
        <div *ngIf="formstrategicResource.invalid && (formstrategicResource.touched || formstrategicResource.dirty)"
             class="validation-error alert alert-danger strategic-error">
          <div *ngIf="formstrategicResource.errors?.['required']" class="validation-error-text">
            منبع استراتجیک اشتباه است
          </div>
        </div>
      </div>
    </div>

    <div class="form-group row">
      <label for="edit-code" class="col-sm-3 col-form-label">کد :</label>
      <div class="col-sm-9">
        <input id="edit-code" type="text" formControlName="code" class="form-control">
        <div *ngIf="formcode.invalid && (formcode.touched || formcode.dirty)"
             class="alert alert-danger validation-error">
          <div *ngIf="formcode.errors?.['required']" class="validation-error-text">
            فیلد کد اشتباه است
          </div>
        </div>
      </div>
    </div>

    <div class="form-group row">
      <label for="edit-warehouse-id" class="col-sm-3 col-form-label">کد انبار :</label>
      <div class="col-sm-9">
        <input id="edit-warehouse-id" type="number" formControlName="warehouseId" class="form-control">
        <div *ngIf="formWarehouseId.invalid && (formWarehouseId.touched || formWarehouseId.dirty)"
             class="alert alert-danger validation-error">
          <div *ngIf="formWarehouseId.errors?.['required']" class="validation-error-text">
            کد انبار اشتباه است
          </div>
        </div>
      </div>
    </div>

    <!-- to avoid overlapping create and edit buttons -->
    <div *ngIf="showEditForm">
      <button class="btn btn-primary pr-4 pl-4" type="submit">تایید</button>
    </div>
  </form>

  <table mat-table [dataSource]="productions" class="production-table">

    <!-- id column -->
    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef>کد اختصاصی</th>
      <td mat-cell *matCellDef="let production">{{production.id}}</td>
    </ng-container>

    <!-- title column -->
    <ng-container matColumnDef="title">
      <th mat-header-cell *matHeaderCellDef>نام</th>
      <td mat-cell *matCellDef="let production">{{production.title}}</td>
    </ng-container>

    <!-- strategic Resource column -->
    <ng-container matColumnDef="strategicResource">
      <th mat-header-cell *matHeaderCellDef>منبع اختصاصی</th>
      <td mat-cell *matCellDef="let production">{{production.strategicResource}}</td>
    </ng-container>

    <!-- code column -->
    <ng-container matColumnDef="code">
      <th mat-header-cell *matHeaderCellDef>کد</th>
      <td mat-cell *matCellDef="let production">{{production.code}}</td>
    </ng-container>

    <!-- Warehouse Id column -->
    <ng-container matColumnDef="warehouseId">
      <th mat-header-cell *matHeaderCellDef>کد انبار</th>
      <td mat-cell *matCellDef="let production">{{production.warehouseId}}</td>
    </ng-container>

    <!-- Edit button column -->
    <ng-container matColumnDef="edit">
      <th mat-header-cell *matHeaderCellDef>ویرایش</th>
      <td mat-cell *matCellDef="let production">
        <button mat-raised-button color="accent" (click)="showEditFormFunc(production.id)">ویرایش</button>
      </td>
    </ng-container>

    <!-- Delete button column -->
    <ng-container matColumnDef="delete">
      <th mat-header-cell *matHeaderCellDef>حذف</th>
      <td mat-cell *matCellDef="let production">
        <button mat-raised-button color="warn" (click)="openDeleteDialog(production.id)">حذف</button>
      </td>
    </ng-container>

    <!-- Rows -->
    <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
    <tr mat-row *matRowDef="let row; columns: columnsToDisplay"></tr>
  </table>
</div>
